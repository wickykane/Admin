<div [@routerTransition]>
    <app-page-header [heading]="'EDIT CUSTOMER'" [icon]="'fa-th-list'"></app-page-header>
    <app-shortcut [listShortcut]='keyService.getKeys()'></app-shortcut>

    <div style="margin: 15px 0">
        <button [keyConfig]="keyService.getKeyConfig()" appKeyNavigate="back_button"
            class="btn btn-outline-dark" [routerLink]="['/customer']">Back To List</button>
    </div>
    <section class="rma-page block main-container block-order">

        <div class="row block-info">
            <div class="col-md-8">
                <div class="card height-100">
                    <div class="card-header">
                        <strong>GENERAL INFORMATION</strong>
                    </div>
                    <div class="card-body">
                        <div class="row information height-100">
                            <div *ngIf="generalForm.value.buyer_type == 'CP'" class="col-md-12">
                                <form [formGroup]="generalForm" class="form-search full-width form-horizontal">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="buyer_type" class="col-md-5 col-form-label">Customer Type
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" disabled name="buyer_type" formControlName="buyer_type" (change)="changeCustomerType()">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of listMaster['customerType']" [ngValue]="item.code">{{item.name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                            </div>                                        
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="code" class="col-md-5 col-form-label">Code
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="code" formControlName="code">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                    <label for="company_name" class="col-md-5 col-form-label">Company Name
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="company_name" formControlName="company_name">
                                                    </div>
                                                </div>
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP' && generalForm.value.is_parent == false">
                                                    <label for="company_name" class="col-md-5 col-form-label">Parent Company</label>
                                                    <div class="col-md-7">
                                                        <span>{{detail?.parent_name}}</span>
                                                    </div>
                                                </div>
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="first_name" class="col-md-5 col-form-label">First Name
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="first_name" formControlName="first_name">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="inputPassword" class="col-md-5 col-form-label">Phone
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input [keyConfig]="keyService.getKeyConfig()" appKeyNavigate="phone"
                                                            type="text" class="form-control" name="phone" formControlName="phone">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">                                
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="last_name" class="col-md-5 col-form-label">Last Name
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="last_name" formControlName="last_name">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="ac" class="col-md-5 col-form-label">Status
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="ac" formControlName="ac">                                                            
                                                            <option value="1">Active</option>
                                                            <option value="0">Inactive</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                    <label for="fax" class="col-md-5 col-form-label">Fax</label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="fax" formControlName="fax">
                                                    </div>
                                                </div>
                                            </div>
                                         </div>
                                        <!--end colum left -->
                                        <div class="col-md-6">
                                            <div class="col-md-12">                                                
                                            <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                <label for="username" class="col-md-5 col-form-label">Username
                                                    <span class="text-danger">(*)</span>
                                                </label>
                                                <div class="col-md-7">
                                                    <input type="text" class="form-control" name="username" formControlName="username">
                                                </div>
                                            </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="password" class="col-md-5 col-form-label">Password
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="password" class="form-control" name="password" formControlName="password">
                                                    </div>
                                                </div>
                                            </div>                                     
                                            <div class="col-md-12">                                                
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="email" class="col-md-5 col-form-label">Email
                                                        <span class="text-danger">(*)</span>
                                                    </label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="email" formControlName="email">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="payment_term_id" class="col-md-5 col-form-label">Default Payment Terms </label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="payment_term_id" formControlName="payment_term_id">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option *ngFor="let item of paymentTermList" [ngValue]="item.id">{{item.cd}} - {{item.des}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12" >
                                                <div class="form-group row">
                                                    <label for="carrier_id" class="col-md-5 col-form-label">Default Carrier</label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="carrier_id" formControlName="carrier_id">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option *ngFor="let item of listCarier" [ngValue]="item.id">{{item.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>                                          
                                            <!-- <div class="w-100"></div> -->   
                                           
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="payment_method_id" class="col-md-5 col-form-label">Default Payment Methods</label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="payment_method_id" formControlName="payment_method_id">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option *ngFor="let item of paymentMethodList" [ngValue]="item.id">{{item.name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                <!-- <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                    <label for="sale_person_id" class="col-md-5 col-form-label">Credit Used</label>
                                                    <div class="col-md-7">
                                                        <input type="text" disabled class="form-control" name="credit_used">
                                                    </div>
                                                </div> -->
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="sale_person_id" class="col-md-5 col-form-label">Salesperson</label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="sale_person_id" formControlName="sale_person_id">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option *ngFor="let item of listMaster['salePersons']" [ngValue]="item.id">{{item.full_name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <div class="w-100"></div> -->                                            
                                           
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label for="taxable" class="col-md-5 col-form-label">Taxable</label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="taxable" formControlName="taxable">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option value="1" selected="true">Yes</option>
                                                            <option value="0" selected="true">No</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                            <!-- <div class="w-100"></div> -->
                                            <div class="col-md-12">
                                                <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                    <label for="registration_no" class="col-md-5 col-form-label">Registration No</label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="registration_no" formControlName="registration_no">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                <!-- <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                    <label for="username" class="col-md-5 col-form-label">Username</label>
                                                    <div class="col-md-7">
                                                        <input type="text" class="form-control" name="username" formControlName="username">
                                                    </div>
                                                </div> -->
                                                <div class="form-group row">
                                                    <label for="sale_person_id" class="col-md-5 col-form-label">Salesperson</label>
                                                    <div class="col-md-7">
                                                        <select class="form-control" name="sale_person_id" formControlName="sale_person_id">
                                                            <option value="null" selected="true">--Select--</option>
                                                            <option *ngFor="let item of listMaster['salePersons']" [ngValue]="item.id">{{item.full_name}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                           
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div *ngIf="generalForm.value.buyer_type == 'PS'" class="col-md-12">
                                    <form [formGroup]="generalForm" class="form-search full-width form-horizontal">
                                        <div class="row">
                                            <div class="col-md-4">
                                                <div class="col-md-12">
                                                        <div class="form-group row">
                                                            <label for="buyer_type" class="col-md-5 col-form-label">Customer Type
                                                                <span class="text-danger">(*)</span>
                                                            </label>
                                                            <div class="col-md-7">
                                                                <select class="form-control" disabled name="buyer_type" formControlName="buyer_type" (change)="changeCustomerType()">
                                                                    <option value="null" selected="true">--Select--</option>
                                                                    <option *ngFor="let item of listMaster['customerType']" [ngValue]="item.code">{{item.name}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                </div>                                        
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="code" class="col-md-5 col-form-label">Code
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="code" formControlName="code">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                        <label for="company_name" class="col-md-5 col-form-label">Company Name
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="company_name" formControlName="company_name">
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP' && generalForm.value.is_parent == false">
                                                        <label for="company_name" class="col-md-5 col-form-label">Parent Company</label>
                                                        <div class="col-md-7">
                                                            <span>{{detail?.parent_name}}</span>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="first_name" class="col-md-5 col-form-label">First Name
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="first_name" formControlName="first_name">
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div class="col-md-12">                                
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="last_name" class="col-md-5 col-form-label">Last Name
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="last_name" formControlName="last_name">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="ac" class="col-md-5 col-form-label">Status
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="ac" formControlName="ac">                                                            
                                                                <option value="1">Active</option>
                                                                <option value="0">Inactive</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                        <label for="fax" class="col-md-5 col-form-label">Fax</label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="fax" formControlName="fax">
                                                        </div>
                                                    </div>
                                                </div>
                                             </div>
                                            <!--end colum left -->
                                            <div class="col-md-4">
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="inputPassword" class="col-md-5 col-form-label">Phone
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input [keyConfig]="keyService.getKeyConfig()" appKeyNavigate="phone"
                                                                type="text" class="form-control" name="phone" formControlName="phone">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">                                                
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="username" class="col-md-5 col-form-label">Username
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="username" formControlName="username">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="password" class="col-md-5 col-form-label">Password
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="password" class="form-control" name="password" formControlName="password">
                                                        </div>
                                                    </div>
                                                </div>                                     
                                                <div class="col-md-12">                                                
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="email" class="col-md-5 col-form-label">Email
                                                            <span class="text-danger">(*)</span>
                                                        </label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="email" formControlName="email">
                                                        </div>
                                                    </div>
                                                </div>                                              
                                                                                 
                                                <!-- <div class="w-100"></div> -->   
                                               
                                               
                                                <div class="col-md-12" *ngIf="generalForm.value.buyer_type == 'PS'">                                                   
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="sale_person_id" class="col-md-5 col-form-label">Salesperson</label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="sale_person_id" formControlName="sale_person_id">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of listMaster['salePersons']" [ngValue]="item.id">{{item.full_name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                             
                                                <div class="col-md-12">
                                                    <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                        <label for="registration_no" class="col-md-5 col-form-label">Registration No</label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="registration_no" formControlName="registration_no">
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12" *ngIf="generalForm.value.buyer_type == 'CP'">
                                                    <!-- <div class="form-group row" *ngIf="generalForm.value.buyer_type == 'PS'">
                                                        <label for="username" class="col-md-5 col-form-label">Username</label>
                                                        <div class="col-md-7">
                                                            <input type="text" class="form-control" name="username" formControlName="username">
                                                        </div>
                                                    </div> -->
                                                    <div class="form-group row">
                                                        <label for="sale_person_id" class="col-md-5 col-form-label">Salesperson</label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="sale_person_id" formControlName="sale_person_id">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of listMaster['salePersons']" [ngValue]="item.id">{{item.full_name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                               
                                            </div>
                                            <div class="col-md-4">
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="payment_term_id" class="col-md-5 col-form-label">Default Payment Terms </label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="payment_term_id" formControlName="payment_term_id">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of paymentTermList" [ngValue]="item.id">{{item.cd}} - {{item.des}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="payment_method_id" class="col-md-5 col-form-label">Default Payment Methods</label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="payment_method_id" formControlName="payment_method_id">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of paymentMethodList" [ngValue]="item.id">{{item.name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-12" >
                                                    <div class="form-group row">
                                                        <label for="carrier_id" class="col-md-5 col-form-label">Default Carrier</label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="carrier_id" formControlName="carrier_id">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option *ngFor="let item of listCarier" [ngValue]="item.id">{{item.name}}</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>     
                                                <div class="col-md-12">
                                                    <div class="form-group row">
                                                        <label for="taxable" class="col-md-5 col-form-label">Taxable</label>
                                                        <div class="col-md-7">
                                                            <select class="form-control" name="taxable" formControlName="taxable">
                                                                <option value="null" selected="true">--Select--</option>
                                                                <option value="1" selected="true">Yes</option>
                                                                <option value="0" selected="true">No</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>    
                                            </div>
                                            <!-- end col 3 -->
                                        </div>
                                    </form>
                                </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card height-100">
                    <div class="card-header">
                        <strong>CREDIT BALANCE INFORMATION</strong>
                    </div>
                    <div class="card-body">
                        <div class="row information height-100">
                            <div class="col-md-12">
                                <form [formGroup]="creditBalanceForm" class="form-search full-width form-horizontal">
                                    <div class="row">
                                        <div class="col-md-12">
                                            <div class="form-group row">
                                                <label for="credit_limit" class="col-md-5 col-form-label">Credit Limit</label>
                                                <div class="col-md-7">
                                                    <label for="credit_limit" class="col-md-5 col-form-label text-success">{{detail?.credit_limit | currency}}</label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <div class="form-group row">
                                                <label for="current_balance" class="col-md-5 col-form-label">Current Balance</label>
                                                <div class="col-md-7">
                                                    <label for="current_balance" class="col-form-label text-success">{{detail?.credit_balance | currency}}
                                                        <span style="text-decoration: underline" class="text-primary">( view balance history)</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12" *ngIf="listMaster['permission'].editstore && detail?.is_parent !== false ">
                                            <div class="form-group row">
                                                <label for="adj_current_balance" class="col-md-5 col-form-label">Adj. Current Balance(+/-)</label>
                                                <div class="col-md-7">
                                                    <input (keyup)="onClickAdj($event.target.value)" type="text" class="form-control" name="adj_current_balance" formControlName="adj_current_balance">
                                                    <span class="text-danger">Ex: Enter 99 to add $99 and -99 to substract $99</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12" *ngIf="listMaster['permission'].editstore && detail?.is_parent !== false" >
                                            <div class="form-group row">
                                                <label for="new_credit_limit" class="col-md-5 col-form-label">Updat Credit Limit</label>
                                                <div class="col-md-7">
                                                    <input (keyup)="onClickCredit($event.target.value)" type="text" class="form-control" name="new_credit_limit" formControlName="new_credit_limit">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12" *ngIf="detail?.is_parent !== false && (adj_current_balance.dirty || new_credit_limit.dirty)">
                                            <div class="form-group row">
                                                <label for="credit_reason" class="col-md-5 col-form-label">Reason</label>
                                                <div class="col-md-7">
                                                    <input type="text" class="form-control" name="credit_reason" formControlName="credit_reason">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-12"  *ngIf="detail?.is_parent !== false">
                                            <div class="form-group row">
                                                <label for="notify" class="col-md-5 col-form-label">Notify customer by email</label>
                                                <div class="col-md-7">                                                   
                                                    <input type="checkbox" class="" name="notify" formControlName="notify">
                                                </div>
                                            </div>
                                        </div>
                                        <!-- <div class="col-md-12"  >
                                            <div class="form-group row">
                                                <label for="email" class="col-md-5 col-form-label">Customer Email
                                                    <span class="text-danger">(*)</span>
                                                </label>
                                                <div class="col-md-7">
                                                    <input type="text" class="form-control" name="email" formControlName="email">
                                                </div>
                                            </div>
                                        </div> -->


                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <div class="row block-info" style="margin-top:15px;">
            <div class="col-sm-12">
                <div class="card no-border">
                    <div class="card-header">
                        ADDRESS:
                        <strong class="text-danger">{{addresses.length}}</strong>
                        <span *ngIf="addresses.length > 1">Records</span>
                        <span *ngIf="addresses.length <= 1">Record</span>

                        <div class="wrap-keyboard right-toggle-button text-danger mr-2 wrap-icon"
                            (click)="flagAddress = !flagAddress; flagAddress && (flagContact = flagSite = false)">
                            <span class="fa" [ngClass]="{'fa-minus': flagAddress,'fa-plus': !flagAddress}"></span>
                        </div>
                    </div>
                    <div class="card-body no-padding">
                        <div *ngIf="flagAddress">
                            <div class="table-responsive list table-fixed-header">
                                <table class="table table-bordered table-order" #addressTable cdArrowTable
                                    [collection]="addresses" [(selectedIndex)]="selectedAddressIndex">
                                    <thead class="bg-white">
                                        <tr>
                                            <th class="tb-w-35"> No </th>
                                            <th> Type </th>
                                            <th> Name
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Country
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Address 1
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Address 2 </th>
                                            <th> City
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> State
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Zip Code
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th class="tb-w-70"> Default </th>
                                            <th class="tb-w-70"> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody [ngClass]="{'limit-height': addresses.length && addresses.length > 5}">
                                        <tr *ngFor="let item of addresses; let i = index" [ngClass]="{'row-selected': i == selectedAddressIndex}">
                                            <td class="tb-w-35">{{i+1}}</td>
                                            <td>
                                                <select class="form-control" name="type" [disabled]="!item.allow_remove" [(ngModel)]="item.type">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listType" [ngValue]="i.id">{{i.name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="name" [(ngModel)]="item.name">
                                            </td>
                                            <td>
                                                <select class="form-control" name="country_code" [(ngModel)]="item.country_code" (change)="changeCountry(item)">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listCountry" [ngValue]="i.cd">{{i.name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="address_line" [(ngModel)]="item.address_1">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="address_line2" [(ngModel)]="item.address_2">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="city" [(ngModel)]="item.city">
                                            </td>
                                            <td>
                                                <select class="form-control" name="state_id" [(ngModel)]="item.state_id">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listState" [ngValue]="i.id">{{i.name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="zip_code" [(ngModel)]="item.zip_code">
                                            </td>
                                            <td class="text-center tb-w-70">
                                                <input type="checkbox" name="is_default" (change)="checkIsDefault($event, i)" [(ngModel)]="item.is_default" [disabled]="item.type==3 || item.type==4">
                                            </td>
                                            <td class="text-center tb-w-70">
                                                <a href="javascript:void(0)" class="btn btn-default" (click)="removeAddress(i)" *ngIf="item.allow_remove">
                                                    <i class="fa fa-times" aria-hidden="true"></i>
                                                </a>
                                                <a href="javascript:void(0)" *ngIf="!item.allow_remove"></a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button type="button" class="btn btn-link mt-2" (click)="addNewAddress()">
                                <i class="fa fa-plus" aria-hidden="true"></i> Add new address</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row" style="margin-top:15px;" *ngIf="generalForm.value.is_parent == true && generalForm.value.buyer_type=='CP'">
            <div class="col-sm-12">
                <div class="card no-border">
                    <div class="card-header">
                        SITES:
                        <strong class="text-danger">{{sites.length}}</strong>
                        <span *ngIf="sites.length > 1">Records</span>
                        <span *ngIf="sites.length <= 1">Record</span>
                        <div class="wrap-keyboard right-toggle-button text-danger mr-2 wrap-icon"
                            (click)="flagSite = !flagSite; flagSite && (flagAddress = flagContact = false)">
                            <span class="fa" [ngClass]="{'fa-minus': flagSite,'fa-plus': !flagSite}"></span>
                        </div>
                    </div>
                    <div class="card-body no-padding">
                        <div *ngIf="flagSite">
                            <div class="table-responsive list table-fixed-header">
                                <table class="table table-bordered table-order" #siteTable cdArrowTable
                                    [collection]="sites" [(selectedIndex)]="selectedSiteIndex">
                                    <thead class="bg-white">
                                        <tr>
                                            <th class="tb-w-35"> No </th>
                                            <th> Site Code </th>
                                            <th> Site Name </th>
                                            <th> Country </th>
                                            <th> Address 1 </th>
                                            <th> Address 2 </th>
                                            <th> City </th>
                                            <th> State </th>
                                            <th> Zip Code </th>
                                            <th class="tb-w-70"> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody [ngClass]="{'limit-height': sites.length && sites.length > 5}">
                                        <tr *ngFor="let item of sites; let i = index" [ngClass]="{'row-selected': i == selectedSiteIndex}">
                                            <td class="tb-w-35">{{i+1}}</td>
                                            <td>
                                                {{item.site_code}}
                                            </td>
                                            <td>
                                                {{item.site_name }}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.country_name}}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.address_1}}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.address_2}}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.city}}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.state_name}}
                                            </td>
                                            <td>
                                                {{item.addresses[0]?.zip_code}}
                                            </td>
                                            <td class="text-center tb-w-70">
                                                <a href="javascript:void(0)" class="btn btn-default" (click)="addNewSite(item,i)">
                                                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                                                </a>
                                                <a href="javascript:void(0)" *ngIf="item.site_id == undefined"
                                                    class="btn btn-default" (click)="(item.id == null) && removeSite(i)">
                                                    <i class="fa fa-times" aria-hidden="true"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button type="button" class="btn btn-link mt-2" (click)="addNewSite()">
                                <i class="fa fa-plus" aria-hidden="true"></i> Add new site</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>



        <!-- <div class="row" style="margin-top:15px;">
            <div class="col-sm-12">
                <div class="card no-border">
                    <div class="card-header">
                        BANK ACCOUNTS:
                        <strong class="text-danger">{{bank_accounts.length}}</strong>
                        <span *ngIf="bank_accounts.length > 1">Records</span>
                        <span *ngIf="bank_accounts.length <= 1">Record</span>
                        <div class="wrap-keyboard right-toggle-button text-danger mr-2 wrap-icon" (click)="flagAccount = !flagAccount">
                            <span class="fa" [ngClass]="{'fa-minus': flagAccount,'fa-plus': !flagAccount}"></span>
                        </div>
                    </div>
                    <div class="card-body no-padding">
                        <div *ngIf="flagAccount">
                            <div class="table-responsive list">
                                <table class="table table-bordered table-order">
                                    <thead class="bg-white">
                                        <tr>
                                            <th> No </th>
                                            <th> Bank Name
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> SWIFT </th>
                                            <th> Branch
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Address </th>
                                            <th> Account Name
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Account No
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> IBAN </th>
                                            <th> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of bank_accounts; let i = index" [ngClass]="{'hidden':item.is_deleted}">
                                            <td>{{i+1}}</td>
                                            <td>
                                                <select class="form-control" name="bank_id" [(ngModel)]="item.bank_id" (change)="changeBank(item)">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listBank" [ngValue]="i.id">{{i.name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" readonly class="form-control-plaintext" name="bank_swift" [(ngModel)]="item.bank_swift">
                                            </td>
                                            <td>
                                                <select class="form-control" name="branch_id" [(ngModel)]="item.branch_id" (change)="changeBranch(item)">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listBranch" [ngValue]="i.id">{{i.branch_name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" readonly class="form-control-plaintext" name="address" [(ngModel)]="item.address">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="account_name" [(ngModel)]="item.account_name">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="account_no" (keypress)="isNumberKeyC($event)" [(ngModel)]="item.account_no">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="iban" [(ngModel)]="item.iban">
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-default" (click)="removeBankAccount(i)">
                                                    <i class="fa fa-times" aria-hidden="true"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button type="button" class="btn btn-link mt-2" (click)="addNewBankAccount()">
                                <i class="fa fa-plus" aria-hidden="true"></i> Add new account</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        <!-- <div class="row" style="margin-top:15px;">
            <div class="col-sm-12">
                <div class="card no-border">
                    <div class="card-header">
                        CREDIT CARDS:
                        <strong class="text-danger">{{credit_cards.length}}</strong>
                        <span *ngIf="credit_cards.length > 1">Records</span>
                        <span *ngIf="credit_cards.length <= 1">Record</span>
                        <div class="wrap-keyboard right-toggle-button text-danger mr-2 wrap-icon" (click)="flagCreditCard = !flagCreditCard">
                            <span class="fa" [ngClass]="{'fa-minus': flagCreditCard,'fa-plus': !flagCreditCard}"></span>
                        </div>
                    </div>
                    <div class="card-body no-padding">
                        <div *ngIf="flagCreditCard">
                            <div class="table-responsive list">
                                <table class="table table-bordered table-order">
                                    <thead class="bg-white">
                                        <tr>
                                            <th> No </th>
                                            <th> Card Type
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Card Name </th>
                                            <th> Card Number
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Cvv
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Expiration Month
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Expiration Year
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let item of credit_cards; let i = index" [ngClass]="{'hidden':item.is_deleted}">
                                            <td>{{i+1}}</td>
                                            <td>
                                                <select class="form-control" name="type" [(ngModel)]="item.type">
                                                    <option value="null" selected="true">--Select--</option>
                                                    <option *ngFor="let i of item.listCard" [ngValue]="i.id">{{i.name}}</option>
                                                </select>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="name" [(ngModel)]="item.name">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="no" [(ngModel)]="item.no">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="cvv" [(ngModel)]="item.cvv">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="expiration_month" [(ngModel)]="item.expiration_month">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="expiration_year" [(ngModel)]="item.expiration_year">
                                            </td>
                                            <td>
                                                <button type="button" class="btn btn-default" (click)="removeCreditCard(i)">
                                                    <i class="fa fa-times" aria-hidden="true"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button type="button" class="btn btn-link mt-2" (click)="addNewCreditCard()">
                                <i class="fa fa-plus" aria-hidden="true"></i> Add new account</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
        <div class="row" style="margin-top:15px;" *ngIf="generalForm.value.buyer_type == 'CP'">
            <div class="col-sm-12">
                <div class="card no-border">
                    <div class="card-header">
                        CONTACTS:
                        <strong class="text-danger">{{contacts.length}}</strong>
                        <span *ngIf="contacts.length > 1">Records</span>
                        <span *ngIf="contacts.length <= 1">Record</span>
                        <div class="wrap-keyboard right-toggle-button text-danger mr-2 wrap-icon"
                            (click)="flagContact = !flagContact; flagContact && (flagAddress = flagSite = false)">
                            <span class="fa" [ngClass]="{'fa-minus': flagContact,'fa-plus': !flagContact}"></span>
                        </div>
                    </div>
                    <div class="card-body no-padding">
                        <div *ngIf="flagContact">
                            <div class="table-responsive list table-fixed-header">
                                <table class="table table-bordered table-order" cdArrowTable #contactTable
                                    [collection]="contacts" [(selectedIndex)]="selectedContactIndex">
                                    <thead class="bg-white">
                                        <tr>
                                            <th class="tb-w-35"> No </th>
                                            <th> Name
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Title </th>
                                            <th> Phone </th>
                                            <th> Fax </th>
                                            <th> Email
                                                <span class="text-danger">(*)</span>
                                            </th>
                                            <th> Username </th>
                                            <th> Password </th>
                                            <th style="width:5rem"> Main Contact </th>
                                            <th class="tb-w-70"> Action </th>
                                        </tr>
                                    </thead>
                                    <tbody [ngClass]="{'limit-height': contacts.length && contacts.length > 5}">
                                        <tr *ngFor="let item of contacts; let i = index" [ngClass]="{'row-selected': i == selectedContactIndex}">
                                            <td class="tb-w-35">{{i+1}}</td>
                                            <td>
                                                <input type="text" class="form-control" name="name" [(ngModel)]="item.name">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="title" [(ngModel)]="item.title">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="phone" [(ngModel)]="item.phone">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="fax" [(ngModel)]="item.fax">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="email" [(ngModel)]="item.email">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" name="username" [(ngModel)]="item.username">
                                            </td>
                                            <td>
                                                <input type="password" class="form-control" name="password" [(ngModel)]="item.password">
                                            </td>
                                            <td class="text-center" style="width:5rem">
                                                <input type="checkbox" class="form-control" (change)="checkIsMain($event, i)"  name="is_main"  [(ngModel)]="item.is_main">
                                            </td>                                            
                                            <td class="text-center tb-w-70">
                                                <a href="javascript:void(0)" class="btn btn-default" (click)="removeContact(i, item.user_id)">
                                                    <i class="fa fa-times" aria-hidden="true"></i>
                                                </a>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button type="button" class="btn btn-link mt-2" (click)="addNewContact()">
                                <i class="fa fa-plus" aria-hidden="true"></i> Add new contact</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="block-content block-content-full text-right" style="margin-top:15px;">
            <button type="button" class="btn btn-default" [routerLink]="['/customer']">Cancel</button>
            <button type="button" [disabled]="generalForm.invalid" class="btn btn-outline-primary" (click)="checkStatus()">Save</button>
        </div>
    </section>
</div>
