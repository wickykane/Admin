<div [@routerTransition]>
    <app-page-header [heading]="'CREATE NEW DISCOUNT BY CATEGORY'" [icon]="'fa-th-list'"></app-page-header>
    <section class="rma-page block">
        <div style="margin: 15px 0">
            <a class="btn btn-outline-info" routerLink="/discount-category">
                <i class="fa fa-arrow-left"></i> Back</a>
        </div>
        <fieldset class="custom-border">
            <legend class="custom-border">GENERAL INFORMATION</legend>
            <form [formGroup]="generalForm" class="form-search full-width form-horizontal">
                <div class="row">
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="code" class="col-sm-4 col-form-label">Code
                              <span class="text-danger">(*)</span>
                          </label>
                            <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" name="code" formControlName="code">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="name" class="col-sm-4 col-form-label">Description
                          </label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control" name="name" formControlName="name">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="start_dt" class="col-sm-4 col-form-label">Start Date</label>
                            <div class="col-sm-8">
                                <div class="input-group">
                                    <input class="form-control" placeholder="yyyy-mm-dd" name="dp" formControlName="start_dt" ngbDatepicker #d1="ngbDatepicker">
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" (click)="d1.toggle()" type="button">
                                            <i class="fa fa-calendar" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="sts" class="col-sm-4 col-form-label">Status
                              <span class="text-danger">(*)</span>
                          </label>
                            <div class="col-sm-8">
                                <select class="form-control" name="sts" formControlName="sts">
                                  <option value="null" selected="true">--Select--</option>
                                  <option *ngFor="let item of listMaster['status']" [ngValue]="item.code">{{item.name}}</option>
                              </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="create_by" class="col-sm-4 col-form-label">Created By
                          </label>
                            <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" name="create_by" formControlName="create_by">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group row">
                            <label for="create_dt" class="col-sm-4 col-form-label">Create Date
                          </label>
                            <div class="col-sm-8">
                                <input type="text" readonly class="form-control-plaintext" name="create_dt" formControlName="create_dt">
                            </div>
                        </div>
                    </div>
                </div>
            </form>

        </fieldset>



        <div class="row" style="margin-top:15px;">
            <div class="col-sm-12">
                <div class="custom-header">
                    <h3 class="custom-header">CATEGORIES:
                        <strong class="text-danger">{{data['products'].length}}</strong>
                        <span *ngIf="data['products'].length > 1">Records</span>
                        <span *ngIf="data['products'].length <= 1">Record</span>
                    </h3>
                    <div class="wrap-keyboard right-toggle-button" (click)="flagAddress = !flagAddress">
                        <span class="fa" [ngClass]="{'fa-minus': flagAddress,'fa-plus': !flagAddress}"></span>
                    </div>
                </div>
                <div *ngIf="flagAddress">
                    <div class="customer-content-toggle">
                        <table class="table table-striped table-vcenter table-hover custom-table">
                            <thead>
                                <tr>
                                    <th> ID </th>
                                    <th> Product Category <span class="text-danger">(*)</span></th>
                                    <th> Apply For SubCategory <span class="text-danger">(*)</span></th>
                                    <th> Discount Value % <span class="text-danger">(*)</span></th>
                                    <th> Action </th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of data['products']; let i = index">
                                    <td>{{i+1}}</td>
                                    <td>
                                        <select class="form-control" name="category_id" [(ngModel)]="item.category_id">
                                            <option value="null" selected="true">--Select--</option>
                                            <option *ngFor="let i of item.listCategory" [ngValue]="i.id">{{i.name}}</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select class="form-control" name="type" [(ngModel)]="item.type">
                                            <option value="null" selected="true">--Select--</option>
                                            <option *ngFor="let i of item.listType" [ngValue]="i.id">{{i.name}}</option>
                                        </select>
                                    </td>
                                    <td>
                                        <select class="form-control" name="type" [(ngModel)]="item.type">
                                            <option value="null" selected="true">--Select--</option>
                                            <option *ngFor="let i of item.listSubCategory" [ngValue]="i.id">{{i.name}}</option>
                                        </select>
                                    </td>
                                    <td>
                                        <input type="text" class="form-control" name="name" [(ngModel)]="item.name">
                                    </td>
                                    <td>
                                        <button type="button" class="btn btn-default" (click)="remove(i)">
                                            <i class="fa fa-times" aria-hidden="true"></i>
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <button type="button" class="btn btn-outline-dark" (click)="addNew()">
                        <i class="fa fa-plus" aria-hidden="true"></i> Add new</button>
                </div>
            </div>
        </div>










        <div class="block-content block-content-full text-center" style="margin-top:15px;">
            <button type="button" class="btn btn-default" [routerLink]="['/customer']">Cancel</button>
            <button type="button" [disabled]="generalForm.invalid" class="btn btn-outline-primary" (click)="createCustomer()">Save</button>
        </div>
    </section>
</div>
